# 简明 OpenTTD 配线教程

*WenSim, Dongfeng<sub>4</sub>3110, Mikhail, Babel, Feb.19, 2024*

<!--建议：通俗部分放前面，晦涩难懂的公式等部分放后面。我们的目标是让三岁小孩也能看懂。涉及原理的部分可以放后面，这也是我在开始写这篇文档的时候大量使用小孩式语言的原因。

目前需要考虑是否要转为 LaTeX，主要是因为使用的公式（效率）不能正确显示等，另外使用 LaTeX 也可以帮助排版。问题是其比较难懂，而且语法规则比较复杂。我们可以采取内容提供 - 编排的混合工作方式。

可以使用 github.dev 来工作，无需 liveshare 等。需要 github 账号。
-->

*第一版*

## 前言

这篇详细解释了 OpenTTD 中的配线以及推荐设置。

> 我知道 OpenTTD 是什么，但是应该怎么配线呢？

首先，我们要知道——什么是配线。

配线是什么呢？配线就是铁路的布置方式。一条条铁路线在给定的沙盒里面自由铺设，好比在图纸上画画，所以我们将铁路称为线。在现实生活中，铁路线需要按照一定的规律铺设，这是为了提高铁路枢纽的效率并让管理与维护更简单。而在 OpenTTD 中，也有类似的需求。我们不想要杂乱无章的铁路线。


> 我想随便修建

请你现在马上离开这篇教程。诚然，OpenTTD 如官方所说“不禁止玩家做傻事”但是这是一篇**正式**教程。

> 那好，我倒要看看这教程里面有什么

很好！你倒是开窍了（笑）。那让我们来看看都有什么吧。

## 目录

- 信号机
    - 路径信号机
    - 逻辑信号机
- 车站设计
    - 普通车站设计
    - 终点站与折返
    - 车辆段/车库
- 列车调度
    - 班次均匀
    - 满载命令
- 线路修建
    - 规划与曲线
    - 坡度
    - 线路规模

- 公式与原理

> 啊！怎么开始就那么复杂？可是我看到别人说……OpenTTD 很简单啊！<!--谁 tama 说的 Openttd 很简单？>

你也许会那么想。那么，就让我们直接进入最基本的——

## 信号机基础知识

游戏里有这样几种信号机：

- 路径信号机
    - 单向路径信号机
    - 路径信号机
- 逻辑信号机
    - 入口信号机
    - 出口信号机
    - 复合信号机
    - 区间信号机

在绝大多数的情况下，你只需要用到路径信号<sup>[来源请求]</sup>。逻辑信号机，如官方所说，“只适用于特殊用途”如逻辑阵列等。让我们首先来看看他们的工作原理。

|信号种类 | 插图 |
|---|---|
|<blockquote>路径信号机会在列车将要通过时检测列车的路径。如果信号机发现列车路径没有被占用，那么信号就会放行。如果信号机发现列车的路径上有障碍，例如另一列列车占用了这条路，信号机就不会放行。<p></p><p>打个比方，这就好比你和小明走路，小明走左边，你走右边，两个人走在同一条路上但是方向不同，这个时候就都可以欢喜地走路。</p></blockquote>|yixie dongxi|
|<blockquote>逻辑信号机，正如其名，是依靠一定的逻辑来判断的。逻辑信号机判断的“逻辑”是前方区间有没有被占用。如果前方区间被占用了，则不会予以放行。<p></p><p>这就好比你和小明走同一条路，不同方向，但是一次只能有一个人走在这条路上，因为正在这条路上行走的人占用了这条路，按照逻辑信号机的逻辑——自然是不能让另一个人通行的了。</p></blockquote>|yixie dongxi |

我们可以看到，在绝大多数的情况下，路径信号机的效率都比逻辑信号机高<sup>[来源请求]</sup>。同时路径式也容易使用。

### 路径信号机

|路径信号机 | 单向路径信号机 |
|---|---|
|||
|常亮红灯，后面没有小牌子 | 常亮红灯，后面有小牌子|

正如前面所说，路径信号机是通过检测列车实际通过的路径来控制放行与否的。

我们可以看一些使用路径信号灯的例子：

|例一：车站 | 例二：交叉口 | 例三：铁路线 |
|---|---|---|
|||
|这里是一个 | 这里是另一个 | 这里的例子|

我们先来看看单向路径信号机

单向路径信号机，机如其名，是**单向**的。使用单向的原因是，在设计线路的时候，我们想要在有限的空间内使效率最大化，将列车约束到一个方向上，便于管理与车站的扩建，所以会使用单向信号机。我们不想让列车从另一个方向进入。

路径信号机的情况就比较特殊了。使用路径信号机的场合相对较多。在建造车站的时候，会大量地在站台两侧使用路径信号机。一些特殊的轨道布置也会使用这种信号机。

路径信号机的特点在于，其允许列车反向越过。我们可以看这张图，显示了甲车与乙车在一个路径信号机前看到的可用区间。

我是图片

我们可以看到，甲车看到的区间范围不受路径信号灯 (机) 的阻挠，这是因为甲车看不到，或者说忽略了背对着它的路径信号机。而乙车则正对着路径信号机。

这里是另外一个例子

我是图片

在这种情况下，由于丙车没有直接面对在中间的路径信号机，其看到的区间范围便是图中的四条轨道。其中三条已经被占用了，在这种情况下，丙车想要进入站台，便会驶入空余的站台。丁车看到的则是车站前咽喉区。丙车会在信号机前搜寻所有可用的站台，假如说没有或者线路被堵住了，丙车就会在信号机前等待。

### 逻辑信号机

<!--他妈的，都这个年份了还有老顽固正常用途用逻辑信号机，怎么没让 2tt 创死你呢-->

必须要声明的一点是，官方是明确**不支持**使用逻辑信号机的。逻辑信号机只适用于特殊场合。另外，我们**强烈不推荐**将逻辑信号机与路径信号机一同使用。
如前文所说，逻辑信号机包括这几种：

- 入口信号机
- 出口信号机
- 复合信号机
- 区间信号机

其中，区间信号机是最简单的一种。这种信号机的逻辑也是最简单的。
出口、复合、入口信号机的逻辑稍微复杂一些

|入口信号机 | 出口信号机 | 复合信号机 | 区间信号机 |
|---|---|---|---|
|我是配图 | 我是配图 | 我是配图 | 我是配图 |
|我是文本 | 我是文本 | 我是文本 | 我是文本|

使用逻辑信号机可以创建二进制计算机等，不表。不过，请一定要记住：**逻辑信号机只适用于特殊用途**。

## 车站与折返设计

在 OpenTTD 的世界中，车站是沟通货物与列车的桥梁。同时，作为车站设计的重要部分，折返设计是复杂而巧妙的。

### 车站设计

> 什么是车站？

车站是列车装卸货，变换行驶方向的路段，设有站台和相关设施，车站的线路数量往往多于铁道本身。（~~旅客是会自己上下车的货物~~）

~~如果您不知道什么是车站我建议您可以去看看生活大百科~~

在一座车站中，有这些“线”：

- 正线：连接车站与车站并直接贯穿/深入车站其中的线路
- 站线（侧线）：站内办理作业的线路。在现实中有到发线、调车线与货物线等，但是在游戏中没有这些。我们统一将其称为到发线。你可以理解成“有站台的线路”。

根据规模，我们可以车站分成这几类：

|单线车站 | 复线车站 | 多线车站 |
|---|---|---|
|我是配图 | 我是配图 | 我是配图 |
|只有一条正线连接车站，具有一条或多条到发线的车站 | 有两条正线连接的车站 | 有多条正线连接的车站|

根据构造，我们可以将车站分成这几类：

|中间站 | 终点站 | 混合站 |
|---|---|---|
|我是配图 | 我是配图 | 我是配图 |
|“两头都通”的车站 | “只通一头”的车站 | “两头通一半”的车站|

#### 信号场模型

> 何为信号场模型？

信号场模型是对各种铁路场站的最一般简化，由**多条轨道**与**路径信号机**组成，用于增强通行能力的特定区间，即一个**只有铁道和信号机的系统**。

> 我们为什么引入信号场模型？

配线的重点在于合理安排铁道和信号机，因此信号场模型可以指导我们**理解配线基础规则**。

进一步地，信号场模型可以粗略反映铁路场站的吞吐量，由此能帮助我们思考如何**提升铁路的利用率**。

> 信号场模型的基本规则？

>- 轨道规则 :
>平行设置的，数量居多的铁道，一条铁道**可且仅可**容纳一列车。
>- 信号机规则 :
>信号机只能在轨道尽头，且为**单个单向路径信号机**或**一对路径信号机**。
>- 正线规则 :
>轨道尽头所连接的铁路线，只要有交叉，必视作**同属一个区间**。


*追加解释：铁道线平交视同一区间，立交视为不同区间*

---

> 如何用信号场模型表达列车容量和接发能力？

<!--这里可以挪到后面去-->

*数学建模，跳过不影响理解*

- 单行轨道：拥有一个单向信号机的轨道，为**单向**提供**1**的列车容量
- 双向轨道：拥有两个路径信号机的轨道，为**双向**各提供**1/2**的列车容量
- 简单接发能力：在指定方向上可用轨道的**列车容量之和**比上指定方向**正线数量**
> - **完整**接发能力：追加考虑正线的区间数，和**切割正线**数
>
> >$\eta_{Gen}$=$\frac {\Sigma(列车容量)}{\left[log_{\Epsilon}\Sigma(切割正线数)+\Epsilon\right]·正线数}$
>
> *常理中，$\eta_{Gen}$的值域为$\eta_{Gen}\in(0,1]$，故后文中$\eta_{Gen}$以百分数书写。*
>
> $\Epsilon$是**交分效率系数**，最大取$\Epsilon_{Reg.}=2e$，最小取$\Epsilon_{Str.}=e$，取决于列车进路的**丰富度**，下文**若未说明，一律取 2e**
>
> 这个公式**不需要理解和记忆**，但$\eta_{Gen}$可以正确反映车站吞吐量的相对大小，只需理解对于铁路场站，该系数**愈大愈好**即可。
---

#### 单线车站

折返类型的设计与路线规模和车站规模密切相关，下作简要分类讨论。

- 单线单轨道车站

当列车运行到单线的尽头，会直接调头相反方向运行，或者继续行驶。这是车站的基本单位，下面提到的**双向站台**就是一个单线单轨道车站。
在信号场模型中，这样车站的列车容量毫无疑问是：1

- 单线多轨道车站（尽头式）

一个**对称的**2n 轨道信号场可以为单线铁道提供单侧为 n，双向为 2n 的列车容量。让我们砍掉一半，成为单行的 n 轨道信号场，理应为单侧提供为 n 的列车容量。再使列车到达后原地掉头，我们得到了一个**单线 n 轨道尽头站**。

每一条站线都可以看作是一座车站，这样，我们又回到上面的情况。一座**单线多轨道尽头站**列车容量为：n

值得注意的是，单线车站在一个站距内只能同时发出一列车（这也被称作站间闭塞
），而发车频率不会因任何设计而改变。从这里开始，单线车站的吞吐量开始**受制于线路规模**，再介绍完通过式车站后，我们将移步至复线铁路。

- 单线多轨道车站（通过式）

上面我们讲到，尽头式车站是**半个信号场**，*如果不砍掉一半呢*？这样，我们的车站本质上是一个**对称的**多轨道信号场，列车无论通过还是折返都不会影响正常运转。单向列车容量仍为：n 而双向为：2n

- 杂项

> 单线车站的最简形态？

在上述的分析后，我们不难得出，一个能满足双向接发终到和通过列车的，最简的车站设计是这样的：

（我是图片）

> 一个轨道数量是奇数的倒霉蛋？

*由于资金和地形等诸多因素的限制，难免会出现车站轨道凑不齐偶数的情况。*当一个单线车站轨道数量为 2n+1 时，为了确保**双向均匀**的前提，我们可以将多出来的一条道做成**双向区间**或**通过线**，*至少我们没有浪费空间，不是么？*

> 如何满足非对称需求？

>> *北京地铁 15 号线的西行 A 快车终到“大屯路东”站，而普通车向西继续运行，假设该线路为单线，我们该怎么有效安排 A 快车的折返？*

我是图片 1

这里的接发车情况显然不是双向均匀的，因此，我们当然可以**偏向一侧**安排站台。我们可以让 3 条线西行，1 条线东行，或在 2 条对开线路的基础上干脆多加一条**专用的折返线**

我是图片 2

> 如何设置通过线？

当我们希望让快车尽快通过时，我们可以设立**通过线**，（*对于单线*，有效的通过线只有一条/堵车警告）将一条轨道的信号灯扒光，就是这样。通过线是正线的一部分，并不属于车站。复线铁路的通过线有额外的复杂度，会另作介绍。



我们单线铁道部分的内容如上。


> 我按照样例修建了，为什么会堵车？

请参见“单向路径信号机”描述。路径信号机具有“反向透明”<sup>[来源请求]</sup>这一神奇的性质，也就是说火车会忽视前方路径上每一个背对它的普通路径信号机。因此，所有站台都使用路径信号机时，每个站台都可以接发来自两个方向的列车。一个方向上在短时内有大量列车进站，这些列车就可能会用完所有可用站台，导致在另一个方向想要进站的列车无法进站。

> 那我继续加站台不就得了？

水多加面，面多加水，在十万甚至九万次这样的循环后你的车站将会极为庞大而臃肿。

> 可是这样……有没有什么简单的解决方案呢？

解决方案相对简单，选出两个或四个站台，将信号灯一半拆除，一半改成单向路径信号灯。这样，你就将这个站台变成了**单向站台**。从对向来的车再多它们也不会使用这些站台。这样可以部分车站在通行上的顺畅。

**详情请见《铁道概论》*

现实中，车站内一般有以下几个类型的股道（线路）：

- 正线：连接车站与车站并直接贯穿/深入其中的线路
- 站线：站内办理作业的线路，包括到发线，调车线，货物线等等等等。但是由于这是神奇到没有任何调车作业的 OpenTTD 世界，下文中将统一用到发线代指站台。
- 段管线/岔线/特殊用途线：神奇的 OpenTTD 世界不需要他们，除非你是一个执着于还原国铁（指中国国家铁路集团公司）车站逆天级别配线的造景狂魔。

OpenTTD 世界中的车站可以小到只有一条站线兼做正线，也可以大到把车站面积调到最大才能放下。但是这不是今天的主题。

> 谁能教教我怎么建设基础到能跑车就行的铁路？

拉一条铁路，建两个车站，找个地方放个车库，买一列火车，设置好调度计划，启动火车。

现在，你已经有了一条至少能跑火车并办理运输业务的铁路。但是当你的铁路运力逐渐不够又该怎么办呢？最简单的办法当然是——

#### 加长列车

也许，你会发现，当你的列车长到站台停不下它，其装卸速度就会变得极为缓慢……这是因为，你的站台 ####长度与列车不匹配！（设置里可以关）
最简单的解决方案就是为你的车站留出足够长的站台（在一些联机服务器，可能会有规定要求各个玩家的车站站台长度相同以便列车过轨）。当然，延长站台所在轨道的长度也是可选办法（但是装车速度依然会十分缓慢）。

> 我的火车已经长的加不下车厢了，这时候怎么办？

好问题！对于这种情况，我推荐你——

#### 增开列车

现在，你的铁路应该还停留在非常原始的状态

|请插入 yuanshidetieluxitong.png|

很明显，如果你就这样贸然增加第二列车进入系统，你的第二列车就永远卡在车库里了。或者你可以让它强行进入，然后与第一列车相撞……

为了应对这种情况，我建议您

#### 扩建车站

> 为什么扩建车站？我就不能在车站后面增加大量轨道吗？

行……但是考虑到其极低的效率与未来水多加面式的大扩张，我还是建议你扩建车站。

单线 <sup>[站与站之间只有一条铁路线链接]</sup> 铁路上，最简单的既可以满足列车交会也最省成本的车站一般长这样——

</blockquote>|请插入 biaozhunzhongjianzhan.png|

如图所示，这是一座很常见的 2 台 2 线<sup>[2 座站台，2 条轨道]</sup>式车站。两条到发线均使用了一架单向路径信号机，使其只能接发来自一个方向的列车，因此不会出现多趟同向来车堵塞车站的问题。-->


### 折返设计简介

> 什么是折返？

折返是列车运行至路线尽头后，向反方向运行前的过程，在某些情况下，路线被认为不具有尽头（*例如灯泡线，详见下文*），因此列车折返往往涉及原地掉头 (~~你游魔法魅力时刻~~) 和切割其它列车运行路线，需要特别的注意以防拥堵。

*只有**列车相对路轨的方向**改变，才被算作是折返。注意，沿着铁道转圈不改变运行方向。*

折返类型的设计与路线规模和车站规模密切相关，下作简要分类讨论。

- 折返的“基本单位”

当列车运行到单线的尽头，会直接调头相反方向运行，这毫无疑问是最简单的折返，是所有折返的基本结构。但单股道折返存在一个问题，即同一条线承担双向运行。

*（**铁道路点**也可作为折返场使用）*

- 单线车站的折返

单线铁路上，每一条站线都可以看作是单股道折返站，这样，我们又回到上面的情况。一座**单线 n 股道尽头站**包含 n 个单股道折返，因此列车容量为：n

值得注意的是，单线车站在一个*站距*内只能同时发出一列车，发车频率不会随车站设计改变，在这里，单线车站的折返效率**受制于线路容量**。

上面我们讲到，尽头式车站是**半个信号场**，*那我们把两个尽头站拼起来不就是双向车站了吗？*因此通过式车站的折返效率与尽头式车站别无二致，列车容量翻倍。

在这个操作的基础上，如果有列车在通过该站后不折返，我们该怎么办呢？答案是**可以不管**，我们的车站是一个**双向均匀的**多股道信号场，拥有其一切功能。

- 路点和车库的妙用

**铁道路点**和**铁道车库**都可以**作为折返站的平替**，理论上，OpenTTD 中的车库是一个股道数量无限，不分方向的~~四次元口袋~~车辆存放场，列车可以进入车库达到调头的目的，因此可以在车站后接车库作为折返线。用车库进行折返的好处之一是列车会在进出车库时**自动维护**，由此省去了在运行途中维护的时间。

- 站后折返的问题

我们先前提到的在站台就地折返并发车的都属于**站前折返**，而在列车出站方向设置车库或路点进行折返，是一种**站后折返**，列车事实上通过了车站，越过了下行的发车信号机后折返。折返后，作为一列上行进站列车**再次**越过车站开回。不难发现，如果列车从车库调头后开回，可能会撞上刚越过的单向信号机，因此，一定要确保站后折返的列车**有途径**顺利通过车站。对于规模较小的车站，将车库/路点放置在正线一旁，并添加连接所有站线的道岔组即可高效解决该问题。

我是图片

*（OpenTTD 默认允许车辆原地掉头，因此站后折返增加了复杂度，且不是必须的）*

- 伪折返——灯泡线

将铁道弯折 180 度并汇入原有线路，列车在其上运行后也可以做到和折返相同的效果，灯泡线通常用于复线铁路，但对于单线铁路也适用，因其线型酷似（白炽）灯泡而得名“灯泡线”。灯泡线可使列车不停车换向（*因转弯半径较小难免损失一些速度*），特别适用于加速慢的重载货运列车等，在现实中还广泛应用于轻轨（此处指轨重）系统中，因其不涉及或只涉及一个单行道岔，被用以减少工程成本。

我是图片

*（OpenTTD 中灯泡线在单线铁路中没什么用）*

#### 复线车站

>还记得**信号机**章节中的小明吗？现在铁路拥有两条轨道！
>
> 复线铁路一般由**对向平行**的两条轨道构成（受制于地势条件等因素，一些复线铁路的上下行线并非完全平行，如丰沙铁路在三家店站——邢家堡站之间上下行线多次立交，甚至线路距离大到要单独为一侧线路设立车站），允许大量列车连续通过，由于每条轨道都是单行的，复线铁路的列车容量在一般情况下极大。
> - 不同于单线铁路，复线铁路的区间长短在一定程度上是任意的。
> - 复线铁路**能满足多数交通线的吞吐量需求**，因此与之相关的铁路场站**最多样，最广泛**。

- 复线车站的分类思路

如前文述，复线铁路中，上下行的分离为列车折返提供了额外复杂度，足以使我们产生数倍于单线车站的分类情况。但倘若我们从下面这个车站入手，就能极大简化这个问题。

我是图片

- **完全通过式车站**：*一个理论最简的复线车站，我们将从这里开始讨论*

> 什么是完全通过式，为什么引入“场”的概念？ 

信号场模型中，列车的后方要么是路径信号灯，要么没有信号灯，因此可以随意折返。然而，复线铁路的各轨道是单行的，因此，虽然信号场模型仍然使用，列车不能像单线车站一样——除非它有办法去到对侧正线上——在任意位置折返并开回正线。
如果列车没有办法去到对侧正线，这便是完全通过式车站了。这样的一个车站，不难看出，上下行轨道完全分离。

相互分离的各部分被称为一个铁路场，简称为“场”，场是一系列功能近似的轨道，常以通行方向，客货用途作为区分依据。在这里，该车站因通行方向被分为上行场和下行场。<br>铁路场常见的分类还有客运场和货运场，普速场和高速场<sub>国铁特有的普高分离，不适用于全部铁道系统</sub><br>在某些大型车站，还会根据铁路连接的方向区分站场，如北京站的京沪场，京秦场。<br>特大型编组站还会进一步细分出上下行到达/发车场，编组场乃至于机车转线场等<sub>OpenTTD 暂无编组机制，但不妨碍我们进行科普（笑）</sub>各个铁路场之间并非处于绝对隔离状态。一些大型车站会建设“场间联络线”沟通各个车场——记得确保你的场间联络线和调度计划不会让跨场列车上演济南铁路局把普速列车错误放行到京沪高铁上这种烂活儿。

我是图片

因为列车只能单向通过，轨道上必是顺方向的一枚单向路径信号机，也因此为所在方向提供 1 的列车容量。，进一步地，在接发需求对称的情况下，上下行场各有 n 条轨道的车站提供 n 的列车容量。<br>据此易得$\eta_{Gen}$=100%，可见，在所有列车都停靠的情况下，这是理论效率最高的复线车站。

> 如何扩展这个车站？

只需按顺序在上下行场增加轨道数即可，这样的操作提升了列车容量，且不妨碍$\eta_{Gen}$仍为 100%，但由于一个场的所有轨道都汇聚于同一条正线，当轨道数量高于复线铁路的容量后，就毫无意义了。

*（信号场模型中的列车容量在复线铁路中意义不大，列车只要不是极端多，一般可认为复线铁路的列车容量是无穷大的）*

> 为了解决折返问题，我们做出了什么妥协？

假设上述车站为该路线上部分列车的终点站，列车需要掉头后前往**对侧正线**，从一侧轨道前往对侧正线必然会先经过本侧正线。让我们添加一条连接两条正线的轨道。<br>这样的路径被称作**切割正线**，体现为与其他正线上行驶的车辆路径相交（且通常不相接），事实上与其他车辆相互阻挡，影响了通行效率。

我是图片

> 如果用桥铁路从上方绕到对面，是否可以避免切割正线？

很遗憾，跨线桥在这里不起任何作用。从信号场模型来理解，列车在进入平行轨道前的全部部分都属于正线区间（“一个区间”原则），进入这个区间又离开，必然要切割正线的，与具体走什么路径无关。

我是图片

> 这是否是唯一的方案，我们损失了多少效率？

通过计算，对下图这个车站中同时接发通过和折返列车的情况而言，$\eta_{Gen}$=90%，话虽如此，但如果折返列车不多，总体的效率仍接近理想的 100%。经过这样的改进，我们的车站能够接发双向的通过和折返列车，成为理论上最简的**一般通过式车站**。

我是图片 1 箭头 我是图片 2

- **一般通过式车站**

> 一般通过式车站的构造

总结上文，一般通过式车站至少由上行场，下行场，渡线三个主要元素组成，单渡线就可以满足列车折返，在这个最简结构基础上，让我们来讨论如何为这个车站进行扩容。

> 如何简便增大车站的接发能力？

我们可以以增加列车容量为目标，顺次向外连接新站台（不要忘记为信号机留空位），假设上下行场各有 n 个站台，并使用单渡线折返，这样的车站拥有相应增大的接发效率，可见下表：

|$N$|$\eta$|$\frac{\eta}{N}$|
|:---:|:---:|:---:|
|轨道数 | 接发效率 | 平均贡献 |
1|91%|91%
2|69%|84%
3|238%|79%
4|302%|75%
5|361%|72%
6|417%|69%
7|470%|67%
8|521%|65%

不难发现，增加站台数切实地提升了车站的接发效率，不过轨道数过多也是不可行的，当轨道数多于 4 时，每条轨道对接发效率的贡献不足 75%/条，又因为外侧轨道距离正线远，列车在站前运行时间会较长，同样影响效率。因此对于一个停车时间较短的客运站，双向四站台（即总共 8 条侧线）是完全足够了，再添加也不会有特大的改观。

> 如果存在大量折返车辆怎么办？

做法分两种，一种是像单线车站一样加开折返专用的尽头式站台，此处不多赘述，本质上还是加站台的事。<br>
另一种做法是在折返效率上寻求提升，具体到问题，因为我们建设的是一个通过站，不能考虑任何形式的额外线路和站后折返。先前使用单渡线的车站中，列车要从上行正线驶入上行场才可折返，前往下行正线。我们为何不把下行场也利用起来呢？添加额外的渡线使列车先前往下行场（需要被改造为双向站台）再折返，这就是**交叉渡线**，交叉渡线会进一步降低接发效率，但客观上有助于发挥全部的列车容量，暂且略过套公式计算环节，从经验角度上讲，还是利大于弊的。


**援引 DF4-这边的东西暂存等待修订**
> 我想在复线铁路车站添加一个“信号场”，这可以吗？

不错啊，你学会举一反三了！（朝鲜式鼓掌与录音的“万岁/”.wav）当然可以！为了保证列车最大的通过效率，可以将“信号场”夹在正线与站台之间，并使用**单向路径信号机**确保列车进出信号场时不会通过切割正线干扰行车秩序（使用普通版也可以，但是切割正线会明显的多起来的）。当然，也有一些人会为了美观（特别是一些造景狂魔）把信号场设置在车站的一侧，并为每条股道设置一对普通路径信号机。这种情况下，虽然保证了在车站设置大规模信号场的同时，停站列车不会因为信号场股道数量变多而大幅度干扰信号场接发列车，但是也导致了大量的切割正线。


### 复线铁路上的终点站（尽头式车站）

在前面，我们已经阐明了终点站的定义—“只通一头”的车站。只有一头通的情况下，列车将会不可避免地在这个车站变更行驶方向。同时，终点站也会作为大量列车的始发站。因此其咽喉区（也就是车站两头很多道岔的地方）将会承担极大的压力，切割正线的现象严重。

现实中，一些尽头站在另一侧同样设有咽喉区供列车折返，当道岔设计受诸多限制时，不妨参照通过式车站的设计规划站后折返，使其等效于一个通过式车站，只是正线在此截止而已。

> 有没有什么可以减轻咽喉区压力的方式？

有！接下来请容我为你介绍**平行进路**！请谨记，路径信号机的原则是“路径不冲突就允许通过”，故车站咽喉区虽只有一个区间（同区间原则），仍可能使多列车同时通行。<br>在正线和站台最简单连接的基础上增加一些**与正线平行的轨道**（足够长），就能创造**平行进路**，一定程度上提升接发效率。<br>现实中，一些规模不大却要接发大量列车的铁路枢纽车站，其行车组织人员会频繁地使用这个方法缓解交叉车流对咽喉区带来的压力。<br>平行进路通常汇入正线，但也可以接入车库或作铁路线与铁路线间的联络线使用。<br>在车流量庞大的大型车站，平行进路法将极为有效的提高列车通行效率。

请插入一张北京丰台站咽喉区图片

如图所示，丰台站普速场通过使用大量的十字渡线道岔（也就是那些长得像个 X 的道岔）创造出许多个平行进路，保证大部分情况下可同时接发京沪/京广线等共计 6 条铁路上的客运列车。(由于丰台站普速场恐怖的 20 站台规模，其咽喉区极为庞大臃肿，一般来说 OpenTTD 世界基本用不到这么大的规模)
> 平行进路如何为终点站减轻压力？

一旦一趟列车利用了平行进路所设置的“辅助股道”进站，那么在咽喉区大量道岔构成的树状组织的帮助下，就有机会为即将切割正线折返的列车创造出一条与进站列车的路线互不干扰的路线，从而减少因为咽喉区占用增长的等待时间。

## 线路修建

线路是沟通车站的手段。得益于游戏的开放性，玩家可以在游戏中修建过山车式轨道。不过，为了最小化成本与最大化效益，在修建线路时进行适当的规划很有必要。

线路的规划应当结合线路类型、线路上的机车类型、当前时代机车功率、途径城镇、途径工业等综合考虑。在修建综合式客货混合运行线路时更应着重考虑机车类型等对线路运营的影响。

### 前期规划

在规划的时候，我们要考虑未来是否要对线路进行扩建，以及是否要在目前线路附近新建线路。

> 我们推荐使用`Planning Tracks`这款 NewGRF 来进行规划工作。在规划完成之后使用轨道转换工具来转换轨道。其他的景观性轨道也可以用来进行轨道规划工作。

在前期规划的时候，我们应当结合这些因素综合考虑线路走向：

|项目 | 说明 |
|---|---|
|线路类型 | 货物线考虑综合效率，客运线更考虑线路里程与速度 |
|机车类型 | 电力机车的功率显著大于内燃机车，一些 GRF 在电力机车内部又分不同的供电制式，相应地，电气化轨道的造价也显著高于非电气化轨道，其中需要取舍 |
|机车功率与功率/重量比 | 功率重量比是$\frac{P}m$ （保留单位），这个比值越大，整列车的加速性能就越好，相应地，线路的坡度就可以留大一些。详情请见子表。这一项对货物列车的影响尤其大。|
|沿线城镇与工业 | 线路主要服务是客运还是货运？应当围绕线路最主要的功能选择线路经过的城镇和工业 |
|运营模式与速度 | 线路形态会制约线路的规模和速度，如果线路未来有升级的可能（单线变复线，扩建车站等），就应该确保线路周边有足够的空间|

### 坡度

如前文所说，玩家可以在游戏中修建过山车式轨道。但是我们不提倡修建这种线路。这种线路缺乏逻辑性与效率，在经验玩家看来是人体思维中枢的部分机制出现错误的表示。过山车轨道不仅对机车的功率，牵引力要求大，还严重限制了列车的牵引重量（例：秦皇岛市地方铁路在驻操营 - 山神庙区段有坡度千分之 44 的特大坡道，因此在平原地带限制牵引 1300 吨的机车在通过此区段时，上山仅能牵引 500 吨。）当只能修建特大坡道的时候，请确保经过这一区间的列车牵引力足够大，不会像太原铁路局的那列 4500 吨试运行列车一样滑下去或者在线路上蠕动！
|错误示例 | 错误示例 | 正确示例 |
|---|---|---|
|我是图片 | 我是图片 | 我是图片 |
|~~禁止拿 RCT2 过山车图片滥竽充数~~|理论上可行，实际上列车在这种轨道上面运行效率会大打折扣 | 正确示例|

> 如何减少坡度对列车运行的影响？

现实中，我们主要采取这 4 种方案：

|方法 | 释义 | 消耗资金量 | 优缺点 | 示例图 |
|---|---|---|---|---|
|逢山开路遇水架桥 | 通过桥梁和隧道连接等高处，以穿过不平整地形 | 较高，且随掘深和架高的增长而增长 | 优点：线型良好，两点一线<br>缺点：烧钱 | 图片 |
|折返展线 | 将坡道的首尾层层相连，令列车在相连处换向 | 最低，只涉及基础铁轨 | 优点：极端廉价<br>缺点：列车频繁折返，绕路多速度慢，调度困难 | 图片 |
|螺旋展线 | 以绕圈的方式在同一路段反复上下坡 | 一般，铁轨较长，或需要短桥隧 | 优点：建设简单，消耗资金量不多<br>缺点：线型不良，绕远路 | 图片 |
|加挂补机 | 在列车编组中添加第二台甚至更多机车，是一种力大砖飞式策略 | 优点：可规避一切线路问题，~~人有多大胆，XXXXX~~<br>缺点：运行成本极端高 | 图片|

### 线路规模

线路的规模至少也要与运力相适应，并有一定的预留提升空间。（这不废话吗？）一般地，线路的规模并非永久恒定不变，会随着沿线工业，城镇的发展逐渐扩张。却又不会像城镇扩张一样毫无限制，铁路线的扩张一般呈现为一条“阶梯”状有终点的折线。

> 为什么会呈现阶梯状，为什么还有终点？

因为每次扩建/改建一条铁路线，都会使得其运力以车站提升容车数/列车编组加长/列车提速等方式发生上涨，运力上涨后就可以开行更多列车，开行列车辆上升到某一水平后运力饱和或过饱和，此时，再次扩建就会重复前序事件产生循环，但是过度扩张同一条铁路势必导致诸如车站规模过大/拆迁量太多/切割正线频繁化等问题。现实世界中，一些极度繁忙的区段会建设三线/四线铁路（如京沪铁路黄村四线与京津三线，广深四线等），此时再在已有四线铁路基础上扩建就有很大可能性导致前述问题。铁路部门将更愿意采取建设并行新线的方式分流同向列车车流（如沈山线与“并行”线路秦沈客运专线）此时其扩张就到达终点。

### 影响线路规模的因素
    线路类型（客运专线？客货混跑？货运专线？亦或者只是一条盲肠一样好几个月来一趟火车的迷你支线铁路？）
    人口分布/工业规模（亲爱的运输组织部门的同志们，你们也不想看到一个万人大城的火车站只有一座站台或者一个小村子的火车站有17台32线吧？）
    资金预算（咱都负债累累马上要倒闭了就别想着修350的高铁再买复兴号了，安安心心修80的破路吧。）
    地理环境（想找出一块平地都难的地方还是先别考虑怎么修高铁了，对吧？）
    车站布置（你是想打造地铁式通勤铁路还是一站直达超级高铁？取决于你。）

    > 线路规模与运力运能不匹配的结果？

    第一条，也是最明显的一条——堵啊！我们现在举一个例子，A站下行方向有1条不能办理作业的正线与1条到发线，，在7:00~7：30之间到发线接发两趟办理客运作业的旅客列车K7711次与K4514次，K7711停车20分钟，K4514停车15分钟。20+15＞31，当K4514次到达A站下行进站信号机时，K7711次尚未作业完毕，K4514次无法进入到发线，只能停车等待（也就是铁路术语的“机外停车”）。而由于此时K4514停于正线等待前序列车，因此K4514次后方的列车都无法通过，造成了大规模的列车晚点甚至产生堵塞。
    |---|
    |图|
    第二条，线路很有可能过饱和。依然是一个例子,甲站与乙站之间的线路设计规模每日通行19对列车，每日可发送19810吨煤炭与893名旅客。由于近日以来乘车旅客量大幅上升，铁路部门不得不在甲-乙站区间加开临时客运列车。此时每日通行车数正好为20对。此时，便会诱发一种我们称之为“列车积压”的问题，通俗的解释就是——火车开不出去了。此时，每天要么是煤车要么是客车，总有一个得有一列开不出去。对于一些有着“货物保鲜”设定的游戏来说，积压列车甚至可能是致命的。
    第三条——如果你是个聪明人的话，可能就会想到“如果火车开不出去了，那我为什么不选择性停运一些列车，使用它们的时刻开行新列车先保障一种货物运输呢？”你确实是个聪明人不假，但是你有没有考虑过因此而来的货物积压呢?

>说回来，这里还能引出一个新章节——

### 线路类型
上一章节，我们已经把线路的类型简单提了一遍，可是，我们并没有讲到一个问题——“为什么我们要给线路分类？”\

这里，我要再为大家引入一个新的概念——“运行线”与“运行图”（此部分属于进阶操作！！！）

> 怎么这么多概念，我不看了！

    出去，没人拦着你。

接下来，我们将对“***运行线*”这个概念简单讲解一下——

    列车运行图是运用坐标原理描述列车运行时间、空间关系，表示列车在铁路各区间运行时间及在各车站停车和通过时间的线条图。一般地，我国使用的列车运行图以横坐标的坐标点表示时间，纵坐标的一条线表示各铁路局集团公司的分界点，车站等重要位置。由无数个点组成一条代表列车的斜线，每个点对应着某时某刻列车所处的位置。由时间/车站坐标与运行线组成的图表即为运行图。<br>运行图编排直接影响到列车的运行。通过铺画运行图，可以在OpenTTD世界中实现货车待避客车，慢车待避快车等进阶操作，但是那就是另一个故事了。

现在，我们假设你的面前有一条客货混跑铁路，其上有货物列车 80km/h，普通旅客列车 120km/h，特快旅客列车 140km/h 三个列车速度标尺。而这条线路并没有规划好运行线，放任列车自由运行的话，会发生什么呢？聪明的你大概已经知道了——运行速度最慢的货物列车将会成为一个移动的路障，导致跟随在任意一趟货物列车后运行的列车都只能压着 80km/h 左右慢慢挪。（在平图——所有列车速度标尺完全一致的线路上就没有这种问题，但这是平图线路唯一的优点了。）同时，你们可能还会发现一件事——货物列车的加速，减速要远远慢于旅客列车，这就导致，很多货物列车在区间连 75km/h 的均速都达不到，一些载重大的货物列车，如大秦铁路的三万吨重载列车，更是需要非常非常非常长的时间起步。<br>而如果这时候我们再加入更多的速度标尺会怎样？现在，160km/h 的直达特快旅客列车与速度高于 200km/h 的动车组列车也要来这儿掺一脚了。此时，你会发现，如果要各种列车都互不干扰运行的话，难度实在***有点儿大** (你确定只是有点儿？) 再加入更多的速度标尺只会把这条铁路引向两种极端——要么大家一起跟着慢车当孙子慢慢跑，要么彻底贯彻“低速无人权”准则，极大拉长慢车待避时间，或者在某个时间段发出大量慢车。可以看到，速度等级太多的话，对于运行图编制和行车组织都是巨大考验，这时，我们就回到了“为什么我们要给线路分类？”这个问题上。答案已经很清楚了——
**为了保障正常的行车组织秩序！**

一般地，我们会依据两种方法分类线路——速度法与运输类型法。前者也就是平常所说的普速铁路与高速铁路（或者更口语一点，火车和高铁。）后者就是我们之前提到的各种啥啥专线了。<br>
