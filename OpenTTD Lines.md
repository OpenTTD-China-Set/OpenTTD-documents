# 简明 OpenTTD 配线教程

*WenSim, Dongfeng<sub>4</sub>3110, Mikhail, Babel, Feb.19, 2024*

*第一版*

## 前言

这篇详细解释了OpenTTD中的配线以及推荐设置。

> 我知道 OpenTTD 是什么，但是应该怎么配线呢？

首先，我们要知道——什么是配线。

配线是什么呢？配线就是铁路的布置方式。一条条铁路线在给定的沙盒里面自由铺设，好比在图纸上画画，所以我们将铁路称为线。在现实生活中，铁路线需要按照一定的规律铺设，这是为了提高铁路枢纽的效率并让管理与维护更简单。而在OpenTTD中，也有类似的需求。我们不想要杂乱无章的铁路线。

> 我想随便修建

请你现在马上离开这篇教程。诚然,OpenTTD如官方所说“不禁止玩家做傻事”但是这是一篇**正式**教程。

> 那好，我倒要看看这教程里面有什么

很好！你倒是开窍了（笑）。那让我们来看看都有什么吧。

## 目录

- 信号机
    - 路径信号机
    - 逻辑信号机
- 车站设计
    - 普通车站设计
    - 终点站与折返
    - 车辆段/车库
- 列车调度
    - 班次均匀
    - 满载命令
- 线路修建
    - 规划与曲线
    - 坡度
    - 线路规模

> 啊！怎么开始就那么复杂？可是我看到别人说……OpenTTD很简单啊！<!--谁说的Openttd很简单？>

你也许会那么想。那么，就让我们直接进入最基本的——

## 信号机基础知识

游戏里有这样几种信号机：

- 路径信号机
    - 单向路径信号机
    - 路径信号机
- 逻辑信号机
    - 入口信号机
    - 出口信号机
    - 复合信号机
    - 区间信号机

在绝大多数的情况下，你只需要用到路径信号<sup>[来源请求]</sup>。逻辑信号机，如官方所说，“只适用于特殊用途”如逻辑阵列等。让我们首先来看看他们的工作原理。

|信号种类|插图|
|---|---|
|<blockquote>路径信号机会在列车将要通过时检测列车的路径。如果信号机发现列车路径没有被占用，那么信号就会放行。如果信号机发现列车的路径上有障碍，例如另一列列车占用了这条路，信号机就不会放行。<p></p><p>打个比方，这就好比你和小明走路，小明走左边，你走右边，两个人走在同一条路上但是方向不同，这个时候就都可以欢喜地走路。</p></blockquote>|yixie dongxi|
|<blockquote>逻辑信号机，正如其名，是依靠一定的逻辑来判断的。逻辑信号机判断的“逻辑”是前方区间有没有被占用。如果前方区间被占用了，则不会予以放行。<p></p><p>这就好比你和小明走同一条路，不同方向，但是一次只能有一个人走在这条路上，因为正在这条路上行走的人占用了这条路，按照逻辑信号机的逻辑——自然是不能让另一个人通行的了。</p></blockquote>|yixie dongxi |

我们可以看到，在绝大多数的情况下，路径信号机的效率都比逻辑信号机高<sup>[来源请求]</sup>。同时路径式也容易使用。

### 路径信号机

|路径信号机|单向路径信号机|
|---|---|
|||
|常亮红灯，后面没有小牌子|常亮红灯，后面有小牌子|

正如前面所说，路径信号机是通过检测列车实际通过的路径来控制放行与否的。

我们可以看一些使用路径信号灯的例子：

|例一：车站|例二：交叉口|例三：铁路线|
|---|---|---|
|||
|这里是一个|这里是另一个|这里的例子|

我们先来看看单向路径信号机

单向路径信号机，机如其名，是**单向**的。使用单向的原因是，在设计线路的时候，我们想要在有限的空间内使效率最大化，将列车约束到一个方向上，便于管理与车站的扩建，所以会使用单向信号机。我们不想让列车从另一个方向进入。

路径信号机的情况就比较特殊了。使用路径信号机的场合相对较多。在建造车站的时候，会大量地在站台两侧使用路径信号机。一些特殊的轨道布置也会使用这种信号机。

路径信号机的特点在于，其允许列车反向越过。我们可以看这张图，显示了甲车与乙车在一个路径信号机前看到的可用区间。

我是图片

我们可以看到，甲车看到的区间范围不受路径信号灯的阻挠，这是因为甲车看不到，或者说忽略了背对着它的路径信号机。而乙车则正对着路径信号机。

这里是另外一个例子

我是图片

在这种情况下，由于丙车没有直接面对在中间的路径信号机，其看到的区间范围便是图中的四条轨道。其中三条已经被占用了，在这种情况下，丙车想要进入站台，便会驶入空余的站台。丁车看到的则是车站前咽喉区。丙车会在信号机前搜寻所有可用的站台，假如说没有或者线路被堵住了，丙车就会在信号机前等待。

### 逻辑信号机

<!--他妈的，都这个年份了还有老顽固正常用途用逻辑信号机，怎么没让2tt创死你呢-->

必须要声明的一点是，官方是明确**不支持**使用逻辑信号机的。逻辑信号机只适用于特殊场合。另外，我们**强烈不推荐**将逻辑信号机与路径信号机一同使用。
如前文所说，逻辑信号机包括这几种：

- 入口信号机
- 出口信号机
- 复合信号机
- 区间信号机

其中，区间信号机是最简单的一种。这种信号机的逻辑也是最简单的。
出口、复合、入口信号机的逻辑稍微复杂一些

|入口信号机|出口信号机|复合信号机|区间信号机|
|---|---|---|---|
|我是配图|我是配图|我是配图|我是配图|
|我是文本|我是文本|我是文本|我是文本|

使用逻辑信号机可以创建二进制计算机等，不表。不过，请一定一定要记住：**逻辑信号机只适用于特殊用途！！！**

## 车站与折返设计

在OpenTTD的世界中，车站是沟通货物与列车的桥梁。作为车站设计的一部分，折返设计也很有必要着重说明。

### 车站设计

> 什么是车站？

车站是列车装卸货，变换行驶方向的路段，设有站台和相关设施，车站的线路数量往往多于铁道本身。（~~旅客是会自己上下车的货物~~）
~~如果您不知道什么是车站我建议您可以去看看生活大百科~~

在一个车站中，有这些“线”：

- 正线：连接车站与车站并直接贯穿/深入其中的线路
- 站线：站内办理作业的线路。在现实中有到发线、调车线与货物线等，但是在游戏中没有这些。我们统一将其称为到发线。你可以理解成“有站台的线路”。

根据规模，我们可以车站分成这几类：

|单线车站|复线车站|多线车站|
|---|---|---|
|我是配图|我是配图|我是配图|
|只有一条正线连接车站，具有一条或多条到发线的车站|有两条正线连接的车站|有多条正线连接的车站|

根据构造，我们可以将车站分成这几类：

|中间站|终点站|混合站|
|---|---|---|
|我是配图|我是配图|我是配图|
|“两头都通”的车站|“只通一头”的车站|“两头通一半”的车站|

#### 单线车站

折返类型的设计与路线规模和车站规模密切相关，下作简要分类讨论。

- 单线单股道车站

当列车运行到单线的尽头，会直接调头相反方向运行，或者继续行驶。这是车站的基本单位，下面提到的**双向站台**就是一个单线单股道车站。
在不考虑车库额外吞吐量的情况下，这样车站的列车容量毫无疑问是：1


- 单线多股道车站（尽头）

我们在**信号场**的解释中曾提到，一个**双向均匀**的2n股道信号场可以为单线铁道提供单侧为n，对向为2n的列车容量。让我们砍掉一半，成为只能朝一个方向通行（二极管?）的n股道信号场，理应为单侧提供为n的列车容量。再使列车到达后原地掉头，我们得到了一个**单线n股道尽头站**。

每一条站线都可以看作是单股道折返站，这样，我们又回到上面的情况。一座**单线多股道尽头站**包含n个单股道折返，因此列车容量为：n

值得注意的是，单线车站在一个站距内只能同时发出一列车，而发车频率不会因任何设计而改变。从这里开始，单线车站的吞吐量开始**受制于线路容量**，再介绍完通过式车站后，我们将移步至复线铁路。

- 单线多股道车站（通过）

上面我们讲到，尽头式车站是**被砍掉一侧的信号场**，*那我们把两个尽头站拼起来不就是双向车站了吗？*此处，我们的车站是一个**双向均匀的**多股道信号场，列车无论通过还是折返都不会影响正常运转。单向列车容量仍为：n 而双向为：2n

- 杂项 单线车站通解

在上述的分析后，我们不难得出，一个能满足双向接发终到和通过列车的，最简的车站设计是这样的：（图：一座对向2股道车站）

> 一个股道数量是奇数的倒霉蛋？

当一个单线车站股道数量为2n+1时，为了确保**双向均匀**的前提，我们可以将多出来的一条道做成**双向区间**或**通过线**，*至少我们没有浪费空间，不是么？*

> 双向不均匀的情况？

*北京地铁15号线的西行A快车终到“大屯路东”站，而普通车向下继续运行，假设该线路为单线，我们该怎么有效安排A快车的折返？*

这里的接发车情况显然不是双向均匀的，因此，我们当然可以**偏向一侧**安排站台。我们可以让3条线西行，1条线东行，或在2条对开线路的基础上干脆多加一条**专用的尽头式折返线**

> 如何设置通过线？

当我们希望让快车尽快通过时，我们可以设立**通过线**，（*对于单线*，有效的通过线只有一条，并可能需要用路点和调度计划规定，以强迫列车经由其）将一条股道的信号灯扒光，就是这样，复线铁路的通过线有额外的复杂度，会另作介绍

我们单线铁道部分的内容如上。

<!-- 
> 我按照样例修建了，为什么会堵车？

请参见“单向路径信号机”描述。路径信号机具有“反向透明”<sup>[来源请求]</sup>这一神奇的性质，也就是说火车会忽视前方路径上每一个背对它的普通路径信号机。因此，所有站台都使用路径信号机时，每个站台都可以接发来自两个方向的列车。一个方向上在短时内有大量列车进站，这些列车就可能会用完所有可用站台，导致在另一个方向想要进站的列车无法进站。

> 那我继续加站台不就得了？

水多加面，面多加水，在十万甚至九万次这样的循环后你的车站将会极为庞大而臃肿。

> 可是这样……有没有什么简单的解决方案呢？

解决方案相对简单，选出两个或四个站台，将信号灯一半拆除，一半改成单向路径信号灯。这样，你就将这个站台变成了**单向站台**。从对向来的车再多它们也不会使用这些站台。这样可以部分车站在通行上的顺畅。

**详情请见《铁道概论》*

现实中，车站内一般有以下几个类型的股道（线路）：

- 正线：连接车站与车站并直接贯穿/深入其中的线路
- 站线：站内办理作业的线路，包括到发线，调车线，货物线等等等等。但是由于这是神奇到没有任何调车作业的OpenTTD世界，下文中将统一用到发线代指站台。
- 段管线/岔线/特殊用途线：神奇的OpenTTD世界不需要他们，除非你是一个执着于还原国铁（指中国国家铁路集团公司）车站逆天级别配线的造景狂魔。

OpenTTD世界中的车站可以小到只有一条站线兼做正线，也可以大到把车站面积调到最大才能放下。但是这不是今天的主题。

> 谁能教教我怎么建设基础到能跑车就行的车站？

拉一条铁路，建两个车站，找个地方放个车库，买一列火车，设置好调度计划，启动火车。

现在，你已经有了一条至少能跑火车并办理运输业务的铁路。但是当你的铁路运力逐渐不够又该怎么办呢？最简单的办法当然是——

#### 加长列车

也许，你会发现，当你的列车长到站台停不下它，其装卸速度就会变得极为缓慢……这是因为，你的站台 ####长度与列车不匹配 ！
最简单的解决方案就是为你的车站留出足够长的站台（在一些联机服务器，可能会有规定要求各个玩家的车站站台长度相同以便列车过轨）。当然，延长站台所在轨道的长度也是可选办法（但是装车速度依然会十分缓慢）。

> 我的火车已经长的加不下车厢了，这时候怎么办？

好问题！对于这种情况，我推荐你——

#### 增开列车

现在，你的铁路应该还停留在非常原始的状态

|请插入yuanshidetieluxitong.png|

很明显，如果你就这样贸然增加第二列车进入系统，你的第二列车就永远卡在车库里了。或者你可以让它强行进入，然后与第一列车相撞……

为了应对这种情况，我建议您

#### 扩建车站

> 为什么扩建车站?我就不能在车站后面增加大量轨道吗？

行……但是考虑到其极低的效率与未来水多加面式的大扩张，我还是建议你扩建车站。

单线 <sup>[站与站之间只有一条铁路线链接]</sup> 铁路上，最简单的既可以满足列车交会也最省成本的车站一般长这样——

</blockquote>|请插入biaozhunzhongjianzhan.png|

如图所示，这是一座很常见的2台2线<sup>[2座站台，2条轨道]</sup>式车站。两条到发线均使用了一架单向路径信号机，使其只能接发来自一个方向的列车，因此不会出现多趟同向来车堵塞车站的问题。-->


### 折返设计

> 什么是折返？

折返是列车运行至路线尽头后，向反方向运行前的过程，在某些情况下，路线被认为不具有尽头（例如灯泡线），因此列车折返往往涉及原地掉头（你游魔法魅力时刻）和切割其它列车运行路线，需要特别的注意以防拥堵。

折返类型的设计与路线规模和车站规模密切相关，下作简要分类讨论。

- 从单线单股道说起

当列车运行到单线的尽头，会直接调头相反方向运行，这毫无疑问是最简单的折返，是所有折返的基本结构。但单股道折返存在一个问题，即同一条线承担双向运行。
在不考虑车库的情况下，这样的折返站的列车容量毫无疑问是：1

*（**铁道路点**也可作为折返场使用）*

- 单线n股道车站（尽头）

我们在**信号场**的解释中曾提到，一个**双向均匀**的2n股道信号场可以为单线铁道提供单侧为n，对向为2n的列车容量。让我们砍掉一半，成为只能朝一个方向通行（二极管?）的n股道信号场，理应为单侧提供为n的列车容量。再使列车到达后原地掉头，我们得到了一个**单线n股道尽头站**。

每一条站线都可以看作是单股道折返站，这样，我们又回到上面的情况。一座**单线n股道尽头站**包含n个单股道折返，因此列车容量为：n

值得注意的是，单线车站在一个站距内只能同时发出一列车，而发车频率不会因任何设计而改变。从这里开始，单线车站的折返开始**受制于线路容量**，再介绍完通过式车站后，我们将移步至复线铁路。

- 单线n股道车站（通过）

上面我们讲到，尽头式车站是**被砍掉一侧的信号场**，*那我们把两个尽头站拼起来不就是双向车站了吗？*

在这个操作的基础上，如果有列车在通过该站后不折返，我们该怎么办呢？答案是**可以不管**，我们的车站是一个**双向均匀的**多股道信号场，列车无论通过还是折返都不会影响正常运转。

- 杂项和单线车站折返通解

在上述的分析后，我们不难得出，一个能满足双向接发终到和通过列车的，最简的车站设计是这样的：（图：一座对向2股道车站）

> 一个股道数量是奇数的倒霉蛋？

当一个单线车站股道数量为2n+1时，为了确保**双向均匀**的前提，我们可以将多出来的一条道做成**双向区间**或**通过线**，*至少我们没有浪费空间，不是么？*

> 双向不均匀的情况？

*北京地铁15号线的西行A快车终到“大屯路东”站，而普通车向下继续运行，假设该线路为单线，我们该怎么有效安排A快车的折返？*

这里的接发车情况显然不是双向均匀的，因此，我们当然可以**偏向一侧**安排站台。我们可以让3条线西行，1条线东行，或在2条对开线路的基础上干脆多加一条**专用的尽头式折返线**

> 如何设置通过线？

当我们希望让快车尽快通过时，我们可以设立**通过线**，（有效的通过线只有一条，并可能需要用路点和调度计划规定，以强迫列车经由其）将一条股道的信号灯扒光，就是这样。

我们单线铁道部分的内容如上。